<div class="form-container">
  <header>
    <nz-radio-group [(ngModel)]="option"
                    [nzSize]="'large'">
      <label nz-radio-button
             nzValue="login">Log in</label>
      <label nz-radio-button
             nzValue="register">Register</label>
    </nz-radio-group>
  </header>
  <section>
    <!-- Register -->
    <form nz-form
          (submit)="register($event)"
          [formGroup]="registerForm"
          [@form]="option === 'register'">
      <nz-form-item>
        <nz-form-control [nzSpan]="24"
                         nzHasFeedback>
          <nz-input-group [nzPrefix]="emailTemplate">
            <input nz-input
                   formControlName="email"
                   type="email"
                   placeholder="Email">
          </nz-input-group>
          <nz-form-explain *ngIf="registerForm.get('email').dirty && registerForm.get('email').errors">
            <ng-container *ngIf="registerForm.get('email').hasError('required')">
              Required
            </ng-container>
            <ng-container *ngIf="registerForm.get('email').hasError('email')">
              Invalid email
            </ng-container>
            <ng-container *ngIf="registerForm.get('email').hasError('duplicated')">
              Already exists
            </ng-container>
          </nz-form-explain>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-control [nzSpan]="24"
                         nzHasFeedback>
          <nz-input-group nzPrefixIcon="anticon anticon-user">
            <input nz-input
                   formControlName="name"
                   placeholder="Name">
          </nz-input-group>
          <nz-form-explain *ngIf="registerForm.get('name').dirty && registerForm.get('name').errors">
            <ng-container *ngIf="registerForm.get('name').hasError('required')">
              Required
            </ng-container>
          </nz-form-explain>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-control [nzSpan]="24"
                         nzHasFeedback>
          <nz-input-group nzPrefixIcon="anticon anticon-lock">
            <input nz-input
                   type="password"
                   formControlName="password"
                   placeholder="Password">
          </nz-input-group>
          <nz-form-explain *ngIf="registerForm.get('password').dirty && registerForm.get('password').errors">
            <ng-container *ngIf="registerForm.get('password').hasError('required')">
              Required
            </ng-container>
            <ng-container *ngIf="registerForm.get('password').hasError('minlength')">
              Min. 6 characters
            </ng-container>
          </nz-form-explain>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-control [nzSpan]="24"
                         nzHasFeedback>
          <nz-input-group nzPrefixIcon="anticon anticon-lock">
            <input nz-input
                   type="password"
                   formControlName="rPassword"
                   placeholder="Comfirm your password">
          </nz-input-group>
          <nz-form-explain *ngIf="registerForm.get('rPassword').dirty && registerForm.get('rPassword').errors">
            <ng-container *ngIf="registerForm.get('rPassword').hasError('required')">
              Comfirm your password
            </ng-container>
            <ng-container *ngIf="registerForm.get('rPassword').hasError('mismatch')">
              Must match your password
            </ng-container>
          </nz-form-explain>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-control [nzSpan]="24">
          <div>
            <label nz-checkbox>Remember me</label>
          </div>
          <button nz-button
                  [nzLoading]="isLoading.register"
                  nzType="primary"
                  class="btn-wide">Register</button>
          <button authGoogleButton
                  nz-button
                  class="btn-wide"
                  [nzLoading]="isLoading.gRegister"
                  (click)="$event.preventDefault()"
                  (token)="gRegister($event)">
            <i class="anticon anticon-google"></i>Register with Google
          </button>
        </nz-form-control>
      </nz-form-item>
    </form>
    <!-- Login -->
    <form nz-form
          (submit)="login($event)"
          [formGroup]="loginForm"
          [@form]="option === 'login'">
      <nz-form-item>
        <nz-form-control [nzSpan]="24">
          <nz-input-group [nzPrefix]="emailTemplate">
            <input type="email"
                   nz-input
                   formControlName="email"
                   placeholder="Email"
                   autofocus>
          </nz-input-group>
          <nz-form-explain *ngIf="loginForm.get('email').errors && loginForm.get('email').dirty">
            <ng-container *ngIf="loginForm.get('email').hasError('wrong')">
              User not registered
            </ng-container>
            <ng-container *ngIf="loginForm.get('email').hasError('email')">
              Invalid email
            </ng-container>
            <ng-container *ngIf="loginForm.get('email').hasError('required')">
              Required
            </ng-container>
          </nz-form-explain>
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-control [nzSpan]="24">
          <nz-input-group nzPrefixIcon="anticon anticon-lock">
            <input type="password"
                   nz-input
                   formControlName="password"
                   placeholder="Password">
          </nz-input-group>
          <nz-form-explain *ngIf="loginForm.get('password').errors && loginForm.get('password').dirty">
            <ng-container *ngIf="loginForm.get('password').hasError('wrong')">
              Wrong password
            </ng-container>
          </nz-form-explain>
        </nz-form-control>
      </nz-form-item>
      <nz-form-item>
        <nz-form-control [nzSpan]="24">
          <div>
            <label nz-checkbox
                   formControlName="remember">Remember me</label>
            <a class="right">Forgot my password</a>
          </div>
          <button nz-button
                  [nzLoading]="isLoading.login"
                  class="btn-wide"
                  nzType="primary">Login</button>
          <button authGoogleButton
                  nz-button
                  [nzLoading]="isLoading.gLogin"
                  class="btn-wide"
                  (click)="$event.preventDefault()"
                  (token)="gLogin($event)">
            <i class="anticon anticon-google"></i>Login with Google
          </button>
          <div>
            Or
            <a (click)="option = 'register'">register</a>
          </div>
        </nz-form-control>
      </nz-form-item>
    </form>
  </section>
</div>

<ng-template #emailTemplate>
  <i class="material-icons">alternate_email</i>
</ng-template>

<div style="display:none">
  <span id="duplicated">Already exists a user with that account</span>
  <span id="inexistent">Unregistered user</span>
  <span id="unknown">Unknown error</span>
</div>